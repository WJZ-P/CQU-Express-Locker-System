# 面向对象系统需求规格说明书

## 1. 引言
本文档采用面向对象分析方法（OOA），通过用例图和用例描述，对“快递柜综合应用系统”的需求进行建模。

## 2. 参与者（Actors）
系统主要包含以下参与者：
1.  **快递员 (Courier)**：负责投递快件、揽收寄件。
2.  **普通用户 (User)**：负责取件、寄件、寄存物品。
3.  **系统管理员 (Administrator)**：负责后台管理与监控。
4.  **柜体硬件 (Locker Hardware)**：包括电磁锁、传感器、摄像头等（由模拟器扮演）。
5.  **短信网关 (SMS Gateway)**：外部系统，用于发送取件码。

## 3. 用例模型（Use Case Model）

### 3.1 总体用例图
*(此处建议插入MDesign生成的总体用例图)*
-   **快递员用例**：登录、投递快件、查询投递记录。
-   **用户用例**：注册/登录、取件（扫码/码）、寄件、寄存、人脸认证。
-   **管理员用例**：登录、设备管理、用户管理、查看报表。

### 3.2 核心用例描述

#### 用例1：投递快件 (Deposit Parcel)
-   **参与者**：快递员
-   **前置条件**：快递员已登录且扫描柜体二维码。
-   **主成功场景**：
    1.  快递员选择“投递快件”。
    2.  系统显示可用格口数量（大/中/小）。
    3.  快递员选择格口类型。
    4.  快递员扫描或输入快递单号。
    5.  系统验证单号并查询收件人手机号（模拟）。
    6.  系统发送开锁指令，柜门弹开。
    7.  快递员放入快件并关门。
    8.  系统检测到关门及物品放入（传感器）。
    9.  系统生成取件码并通过短信网关发送给收件人。
    10. 更新订单状态为“待取件”。
-   **扩展流程**：
    -   3a. 无可用格口：提示快递员更换柜体或等待。
    -   8a. 关门但未检测到物品：提示快递员确认是否放入，或取消投递。

#### 用例2：取件 (Pickup Parcel)
-   **参与者**：用户
-   **前置条件**：用户收到取件码或使用App。
-   **主成功场景**：
    1.  用户在柜体屏幕选择“取件”。
    2.  用户输入6位取件码。
    3.  系统验证取件码有效性。
    4.  系统发送开锁指令，对应柜门弹开。
    5.  用户取出快件并关门。
    6.  系统检测到物品取出。
    7.  更新订单状态为“已取件”。
-   **变体**：
    -   **扫码取件**：用户使用App扫描柜体二维码，系统自动识别用户待取订单并开门。

#### 用例3：寄存物品 (Store Item)
-   **参与者**：用户
-   **主成功场景**：
    1.  用户扫码进入“寄存模式”。
    2.  选择格口大小并支付押金（模拟）。
    3.  柜门打开，用户放入物品。
    4.  系统生成“临时取件码”展示给用户。
    5.  用户将码分享给取件人。

## 4. 领域模型（Domain Model）
主要业务对象包括：
-   **Locker (快递柜)**：包含多个Box。
-   **Box (格口)**：属性包括ID、尺寸、状态（空闲/占用/故障）。
-   **Parcel (快件)**：关联订单号、物流信息。
-   **Order (订单)**：类型（投递/寄件/寄存）、状态、时间戳。
-   **UserAccount (账户)**：基类，派生出CourierAccount和MemberAccount。

## 5. 补充规约
-   **并发性**：系统需处理多个柜体同时上传状态的情况。
-   **持久化**：所有操作记录需写入数据库以备审计。
