# 快递柜系统后端接口文档

> 本文档基于 Android 客户端需求整理，所有接口均**未实现**，等待后端同学实现。

## 服务配置

| 配置项 | 值 |
|--------|-----|
| 本地端口号 | **6666** |
| 本地基础URL | `http://localhost:6666/api/v1` |

---

## 目录

1. [认证模块](#1-认证模块)
2. [用户模块](#2-用户模块)
3. [快递模块](#3-快递模块)
4. [寄存模块](#4-寄存模块)
5. [快递柜模块](#5-快递柜模块)
6. [快递员模块](#6-快递员模块)
7. [历史记录模块](#7-历史记录模块)

---

## 通用说明

### 基础路径
```
Base URL: http://{server}:{port}/api/v1
```

### 通用响应格式
```json
{
  "code": 200,
  "message": "success",
  "data": {}
}
```

### 错误码说明
| 错误码 | 说明 |
|--------|------|
| 200 | 成功 |
| 400 | 请求参数错误 |
| 401 | 未授权/Token失效 |
| 403 | 权限不足 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

### 认证方式
除登录、注册、发送验证码外，其他接口需在 Header 中携带 Token：
```
Authorization: Bearer {token}
```

---

## 1. 认证模块

### 1.1 用户登录
**状态**: ❌ 未实现

```
POST /auth/login
```

**请求体**:
```json
{
  "phone": "13800138000",
  "password": "123456"
}
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userId": "10001",
    "userType": "user",
    "nickname": "张三"
  }
}
```

---

### 1.2 发送验证码
**状态**: ❌ 未实现

```
POST /auth/send-code
```

**请求体**:
```json
{
  "phone": "13800138000",
  "type": "register"
}
```

> type 可选值: `register`(注册), `reset`(重置密码)

**响应**:
```json
{
  "code": 200,
  "message": "验证码已发送",
  "data": null
}
```

---

### 1.3 用户注册
**状态**: ❌ 未实现

```
POST /auth/register
```

**请求体**:
```json
{
  "phone": "13800138000",
  "password": "123456",
  "verifyCode": "123456",
  "userType": "user"
}
```

> userType 可选值: `user`(普通用户), `courier`(快递员)

**响应**:
```json
{
  "code": 200,
  "message": "注册成功",
  "data": {
    "userId": "10001"
  }
}
```

---

## 2. 用户模块

### 2.1 获取用户信息
**状态**: ❌ 未实现

```
GET /user/profile
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "userId": "10001",
    "phone": "138****8000",
    "nickname": "张三",
    "bindLockers": [
      {
        "lockerId": "L001",
        "lockerName": "A区1号柜",
        "address": "重庆大学A区第一教学楼"
      }
    ]
  }
}
```

---

### 2.2 更新用户信息
**状态**: ❌ 未实现

```
PUT /user/profile
```

**请求体**:
```json
{
  "nickname": "李四"
}
```

**响应**:
```json
{
  "code": 200,
  "message": "更新成功",
  "data": null
}
```

---

## 3. 快递模块

### 3.1 获取待取快递列表
**状态**: ❌ 未实现

```
GET /express/pending
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 2,
    "list": [
      {
        "expressId": "EX20260122001",
        "trackingNo": "SF1234567890",
        "company": "顺丰速运",
        "lockerName": "A区1号柜",
        "compartmentNo": "A-12",
        "status": "pending",
        "arrivalTime": "2026-01-22 10:30:00",
        "pickupCode": "123456",
        "deadline": "2026-01-25 10:30:00"
      },
      {
        "expressId": "EX20260122002",
        "trackingNo": "YT9876543210",
        "company": "圆通速递",
        "lockerName": "B区2号柜",
        "compartmentNo": "B-05",
        "status": "pending",
        "arrivalTime": "2026-01-21 15:20:00",
        "pickupCode": "654321",
        "deadline": "2026-01-24 15:20:00"
      }
    ]
  }
}
```

---

### 3.2 获取快递详情
**状态**: ❌ 未实现

```
GET /express/{expressId}
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "expressId": "EX20260122001",
    "trackingNo": "SF1234567890",
    "company": "顺丰速运",
    "lockerName": "A区1号柜",
    "lockerAddress": "重庆大学A区第一教学楼",
    "compartmentNo": "A-12",
    "compartmentSize": "medium",
    "status": "pending",
    "arrivalTime": "2026-01-22 10:30:00",
    "pickupCode": "123456",
    "deadline": "2026-01-25 10:30:00",
    "senderName": "王五",
    "senderPhone": "139****9000",
    "receiverName": "张三",
    "receiverPhone": "138****8000"
  }
}
```

---

### 3.3 取件（验证取件码）
**状态**: ❌ 未实现

```
POST /express/pickup
```

**请求体**:
```json
{
  "expressId": "EX20260122001",
  "pickupCode": "123456"
}
```

**响应**:
```json
{
  "code": 200,
  "message": "取件成功，柜门已打开",
  "data": {
    "compartmentNo": "A-12",
    "lockerName": "A区1号柜"
  }
}
```

---

### 3.4 开柜（已验证后再次开柜）
**状态**: ❌ 未实现

```
POST /express/open
```

**请求体**:
```json
{
  "expressId": "EX20260122001"
}
```

**响应**:
```json
{
  "code": 200,
  "message": "柜门已打开",
  "data": null
}
```

---

### 3.5 寄件
**状态**: ❌ 未实现

```
POST /express/send
```

**请求体**:
```json
{
  "company": "顺丰速运",
  "senderName": "张三",
  "senderPhone": "13800138000",
  "senderAddress": "重庆大学A区学生宿舍",
  "receiverName": "李四",
  "receiverPhone": "13900139000",
  "receiverAddress": "北京市海淀区xxx街道",
  "itemType": "日用品",
  "weight": "1.5",
  "remark": "易碎物品，轻拿轻放"
}
```

**响应**:
```json
{
  "code": 200,
  "message": "寄件申请已提交",
  "data": {
    "orderId": "SO20260122001",
    "estimatedPickupTime": "2026-01-22 18:00:00",
    "estimatedFee": 15.00
  }
}
```

---

## 4. 寄存模块

### 4.1 创建寄存订单
**状态**: ❌ 未实现

```
POST /storage/create
```

**请求体**:
```json
{
  "lockerId": "L001",
  "compartmentSize": "medium",
  "duration": 24,
  "itemDescription": "书包"
}
```

> compartmentSize 可选值: `small`(小), `medium`(中), `large`(大)
> duration 单位: 小时

**响应**:
```json
{
  "code": 200,
  "message": "寄存成功",
  "data": {
    "storageId": "ST20260122001",
    "compartmentNo": "A-15",
    "openCode": "789012",
    "expireTime": "2026-01-23 14:30:00",
    "fee": 2.00
  }
}
```

---

### 4.2 获取寄存列表
**状态**: ❌ 未实现

```
GET /storage/list
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 1,
    "list": [
      {
        "storageId": "ST20260122001",
        "lockerName": "A区1号柜",
        "compartmentNo": "A-15",
        "compartmentSize": "medium",
        "status": "active",
        "createTime": "2026-01-22 14:30:00",
        "expireTime": "2026-01-23 14:30:00",
        "openCode": "789012",
        "itemDescription": "书包"
      }
    ]
  }
}
```

---

## 5. 快递柜模块

### 5.1 获取快递柜列表
**状态**: ❌ 未实现

```
GET /locker/list
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "lockerId": "L001",
        "lockerName": "A区1号柜",
        "address": "重庆大学A区第一教学楼",
        "availableSmall": 5,
        "availableMedium": 3,
        "availableLarge": 2,
        "status": "online"
      },
      {
        "lockerId": "L002",
        "lockerName": "B区2号柜",
        "address": "重庆大学B区图书馆",
        "availableSmall": 10,
        "availableMedium": 8,
        "availableLarge": 0,
        "status": "online"
      }
    ]
  }
}
```

---

### 5.2 获取快递柜详情
**状态**: ❌ 未实现

```
GET /locker/{lockerId}
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "lockerId": "L001",
    "lockerName": "A区1号柜",
    "address": "重庆大学A区第一教学楼",
    "status": "online",
    "compartments": {
      "small": { "total": 20, "available": 5, "pricePerHour": 0.5 },
      "medium": { "total": 15, "available": 3, "pricePerHour": 1.0 },
      "large": { "total": 10, "available": 2, "pricePerHour": 1.5 }
    },
    "businessHours": "00:00-24:00",
    "contactPhone": "400-123-4567"
  }
}
```

---

## 6. 快递员模块

### 6.1 获取快递员信息
**状态**: ❌ 未实现

```
GET /courier/profile
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "courierId": "C001",
    "name": "王快递",
    "phone": "137****7000",
    "company": "顺丰速运",
    "bindLockers": [
      {
        "lockerId": "L001",
        "lockerName": "A区1号柜"
      },
      {
        "lockerId": "L002",
        "lockerName": "B区2号柜"
      }
    ],
    "todayDelivered": 25,
    "todayCollected": 10
  }
}
```

---

### 6.2 投递快递
**状态**: ❌ 未实现

```
POST /courier/deliver
```

**请求体**:
```json
{
  "lockerId": "L001",
  "compartmentSize": "medium",
  "trackingNo": "SF1234567890",
  "receiverPhone": "13800138000",
  "receiverName": "张三"
}
```

**响应**:
```json
{
  "code": 200,
  "message": "投递成功",
  "data": {
    "expressId": "EX20260122003",
    "compartmentNo": "A-18",
    "pickupCode": "456789"
  }
}
```

---

### 6.3 查询收件人信息
**状态**: ❌ 未实现

```
GET /courier/query-receiver?phone=13800138000
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "userId": "10001",
    "name": "张三",
    "phone": "138****8000",
    "defaultLocker": {
      "lockerId": "L001",
      "lockerName": "A区1号柜"
    }
  }
}
```

---

### 6.4 获取待揽收列表
**状态**: ❌ 未实现

```
GET /courier/pending-collect
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 2,
    "list": [
      {
        "orderId": "SO20260122001",
        "senderName": "张三",
        "senderPhone": "138****8000",
        "senderAddress": "重庆大学A区学生宿舍",
        "receiverAddress": "北京市海淀区xxx街道",
        "itemType": "日用品",
        "weight": "1.5",
        "createTime": "2026-01-22 12:00:00",
        "remark": "易碎物品"
      }
    ]
  }
}
```

---

### 6.5 获取待退回列表
**状态**: ❌ 未实现

```
GET /courier/pending-return
```

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 1,
    "list": [
      {
        "expressId": "EX20260120001",
        "trackingNo": "SF1111111111",
        "lockerName": "A区1号柜",
        "compartmentNo": "A-05",
        "arrivalTime": "2026-01-20 10:00:00",
        "deadline": "2026-01-23 10:00:00",
        "overdueHours": 48,
        "receiverName": "赵六",
        "receiverPhone": "136****6000"
      }
    ]
  }
}
```

---

### 6.6 开柜操作
**状态**: ❌ 未实现

```
POST /courier/open-compartment
```

**请求体**:
```json
{
  "lockerId": "L001",
  "compartmentNo": "A-12",
  "operationType": "deliver"
}
```

> operationType 可选值: `deliver`(投递), `collect`(揽收), `return`(退回取出)

**响应**:
```json
{
  "code": 200,
  "message": "柜门已打开",
  "data": null
}
```

---

## 7. 历史记录模块

### 7.1 获取历史记录
**状态**: ❌ 未实现

```
GET /history?type=all&page=1&pageSize=20
```

> type 可选值: `all`(全部), `pickup`(取件), `send`(寄件), `storage`(寄存)

**响应**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 50,
    "page": 1,
    "pageSize": 20,
    "list": [
      {
        "recordId": "R001",
        "type": "pickup",
        "title": "顺丰速运 SF1234567890",
        "lockerName": "A区1号柜",
        "compartmentNo": "A-12",
        "time": "2026-01-22 14:30:00",
        "status": "completed"
      },
      {
        "recordId": "R002",
        "type": "send",
        "title": "寄件至北京市海淀区",
        "company": "顺丰速运",
        "trackingNo": "SF9999999999",
        "time": "2026-01-21 10:00:00",
        "status": "in_transit"
      },
      {
        "recordId": "R003",
        "type": "storage",
        "title": "临时寄存",
        "lockerName": "B区2号柜",
        "compartmentNo": "B-08",
        "time": "2026-01-20 09:00:00",
        "status": "completed"
      }
    ]
  }
}
```

---

## 接口实现进度

| 模块 | 接口 | 状态 |
|------|------|------|
| 认证 | POST /auth/login | ❌ 未实现 |
| 认证 | POST /auth/send-code | ❌ 未实现 |
| 认证 | POST /auth/register | ❌ 未实现 |
| 用户 | GET /user/profile | ❌ 未实现 |
| 用户 | PUT /user/profile | ❌ 未实现 |
| 快递 | GET /express/pending | ❌ 未实现 |
| 快递 | GET /express/{expressId} | ❌ 未实现 |
| 快递 | POST /express/pickup | ❌ 未实现 |
| 快递 | POST /express/open | ❌ 未实现 |
| 快递 | POST /express/send | ❌ 未实现 |
| 寄存 | POST /storage/create | ❌ 未实现 |
| 寄存 | GET /storage/list | ❌ 未实现 |
| 快递柜 | GET /locker/list | ❌ 未实现 |
| 快递柜 | GET /locker/{lockerId} | ❌ 未实现 |
| 快递员 | GET /courier/profile | ❌ 未实现 |
| 快递员 | POST /courier/deliver | ❌ 未实现 |
| 快递员 | GET /courier/query-receiver | ❌ 未实现 |
| 快递员 | GET /courier/pending-collect | ❌ 未实现 |
| 快递员 | GET /courier/pending-return | ❌ 未实现 |
| 快递员 | POST /courier/open-compartment | ❌ 未实现 |
| 历史 | GET /history | ❌ 未实现 |

---

## 更新日志

| 日期 | 版本 | 说明 |
|------|------|------|
| 2026-01-22 | v1.0.0 | 初始版本，基于 Android 客户端需求整理 |
